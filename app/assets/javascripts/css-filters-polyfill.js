(function(e){var t={_ie:function(){var e,t=3,n=document.createElement("div"),r=n.getElementsByTagName("i");while(n.innerHTML="<!--[if gt IE "+ ++t+"]><i></i><![endif]-->",r[0]);return t>4?t:e}(),_svg_cache:{},_create_svg_element:function(e,t){var n="http://www.w3.org/2000/svg";var r=document.createElementNS(n,e);for(key in t){r.setAttributeNS(null,key,t[key])}return r},_create_svg:function(e,t){var n="http://www.w3.org/2000/svg";var r=document.createElementNS(n,"svg");r.setAttributeNS(null,"width","0");r.setAttributeNS(null,"height","0");r.setAttributeNS(null,"style","position:absolute");var i=document.createElementNS(n,"filter");i.setAttributeNS(null,"id",e);r.appendChild(i);for(var s=0;s<t.length;s++){i.appendChild(t[s])}return r},_pending_stylesheets:0,_stylesheets:[],_development_mode:function(){if(location.hostname==="localhost"||location.hostname.search(/.local$/)!==-1||location.hostname.search(/\d+\.\d+\.\d+\.\d+/)!==-1){if(e.console)console.log("Detected localhost or IP address. Assuming you are a developer. Caching of stylesheets is disabled.");return true}if(e.console)console.log("Caching of stylesheets is enabled. You need to refresh twice to see any changes.");return false}(),process_stylesheets:function(){var n=[];e.setTimeout(function(){if(e.XMLHttpRequest){var t=new XMLHttpRequest}else if(e.ActiveXObject){var t=new ActiveXObject("Microsoft.XMLHTTP")}t.open("GET",e.polyfilter_scriptpath+"htc/sepia.htc",true);t.onreadystatechange=function(){if(n.readyState==4&&n.status!=200){alert('The configured path \r\rvar polyfilter_scriptpath = "'+e.polyfilter_scriptpath+'"\r\rseems wrong!\r\rConfigure the polyfill\'s correct absolute(!) script path before referencing the css-filters-polyfill.js, like so:\r\rvar polyfilter_scriptpath = "/js/css-filters-polyfill/";\r\rLeaving IE dead in the water is no option. You damn Mac user... ;)')}};try{t.send(null)}catch(r){}},2e3);var r=document.querySelectorAll?document.querySelectorAll('style,link[rel="stylesheet"]'):document.getElementsByTagName("*");for(var i=0;i<r.length;i++){(function(n){switch(r[n].nodeName){default:break;case"STYLE":t._stylesheets.push({media:r[n].media||"all",content:r[n].innerHTML});break;case"LINK":if(r[n].rel==="stylesheet"){var i=t._stylesheets.length;t._stylesheets.push({media:r[n].media||"all"});t._pending_stylesheets++;var s=r[n].href;if(!t._development_mode&&e.localStorage&&e.localStorage.getItem("polyfilter_"+s)){t._pending_stylesheets--;t._stylesheets[i].content=localStorage.getItem("polyfilter_"+s);if(t._pending_stylesheets===0){t.process()}}try{if(e.XMLHttpRequest){var o=new XMLHttpRequest}else if(e.ActiveXObject){var o=new ActiveXObject("Microsoft.XMLHTTP")}o.open("GET",s,true);o.onreadystatechange=function(){if(o.readyState===4){if(o.status===0){if(e.console)console.log("Could not fetch external CSS via HTTP-Request "+s+". Probably because of cross origin.");if(!t._stylesheets[i].content){t._pending_stylesheets--;t._stylesheets[i].content=o.responseText;if(t._pending_stylesheets===0){t.process()}}}else{if(!t._stylesheets[i].content){t._pending_stylesheets--;t._stylesheets[i].content=o.responseText;if(t._pending_stylesheets===0){t.process()}}if(!t._development_mode&&e.localStorage){try{e.localStorage.setItem("polyfilter_"+s,t._stylesheets[i].content)}catch(n){if(e.console)console.log("Local storage quota have been exceeded. Caching of stylesheet "+s+" is not possible")}}}}};try{o.send(null)}catch(u){if(e.console)console.log("Could not fetch external CSS via HTTP-Request "+s+". Are you maybe testing using the file://-protocol?");if(!t._stylesheets[i].content){t._pending_stylesheets--;if(t._pending_stylesheets===0){t.process()}}}}catch(u){}}break}})(i)}if(this._pending_stylesheets===0){this.process()}},_processDeclarations:function(e){var n="";for(var r in e.declarations){var i=e.declarations[r];if(i.property==="filter"){if(document.querySelectorAll){var s=document.querySelectorAll(e.mSelectorText);for(var r=0;r<s.length;r++){s[r].style.polyfilterStore=i.valueText}}var o=i.valueText;var u=o.split(/\)\s+/),a={filtersW3C:[],filtersWebKit:[],filtersSVG:[],filtersIE:[],behaviorsIE:[]};for(idx in u){var f=u[idx]+")";currentproperties=t.convert(f);for(key in currentproperties){if(typeof a[key]!=="undefined"){a[key]=a[key].concat(currentproperties[key])}}}n+=e.mSelectorText+"{";if(a["filtersW3C"].length>0){var l=webkitFilter=mozFilter=oFilter=msFilter=a["filtersW3C"].join(" ");if(a["filtersWebKit"]&&a["filtersWebKit"].length>0){webkitFilter=a["filtersWebKit"].join(" ")}if(typeof this._ie==="undefined"){n+="-ms-filter:"+msFilter+";"}n+="-webkit-filter:"+webkitFilter+";";n+="-moz-filter:"+mozFilter+";";n+="-o-filter:"+oFilter+";"}if(a["filtersSVG"].length>0){if(a["filtersSVG"][0]!="none"){var c=o.replace(/[^a-z0-9]/g,"");if(typeof this._svg_cache[c]==="undefined"){this._svg_cache[c]=this._create_svg(c,a["filtersSVG"]);if(typeof XMLSerializer==="undefined"){document.body.appendChild(this._svg_cache[c])}else{var h=new XMLSerializer;var p=h.serializeToString(this._svg_cache[c]);if(p.search("SourceGraphic")!=-1){document.body.appendChild(this._svg_cache[c])}}}if(typeof XMLSerializer==="undefined"){n+="filter: url(#"+c+")"}else{var h=new XMLSerializer;var p=h.serializeToString(this._svg_cache[c]);if(p.search("SourceGraphic")!=-1){n+="filter: url(#"+c+")"}else{n+="filter: url('data:image/svg+xml;utf8,"+p+"#"+c+"')"}}}else{n+="filter: none;"}}if(typeof this._ie!=="undefined"){if(a["filtersIE"].length>0){var d=a["filtersIE"].join(" ");n+="filter:"+d+";"}if(a["behaviorsIE"].length>0){var v=a["behaviorsIE"].join(" ");n+="behavior:"+v+";"}}n+="}\r\n"}}return n},scriptpath:e.polyfilter_scriptpath?e.polyfilter_scriptpath:function(){alert('Please configure the polyfill\'s absolute(!) script path before referencing the css-filters-polyfill.js, like so:\r\nvar polyfilter_scriptpath = "/js/css-filters-polyfill/";');return"./"}(),process:function(){var e=new CSSParser;for(var n=0;n<this._stylesheets.length;n++){var r="";var i=e.parse(this._stylesheets[n].content,false,true);if(i!==null)for(var s in i.cssRules){var o=i.cssRules[s];switch(o.type){default:break;case 1:r+=this._processDeclarations(o);break;case 4:r+="@media "+o.media.join(",")+"{";for(var u in o.cssRules){var a=o.cssRules[u];r+=this._processDeclarations(a)}r+="}";break}}var f=document.createElement("style");f.setAttribute("media",this._stylesheets[n].media);if(typeof t._ie==="undefined"){f.innerHTML=r;document.getElementsByTagName("head")[0].appendChild(f)}else{document.getElementsByTagName("head")[0].appendChild(f);f.styleSheet.cssText=r}}},init:function(){if(Object.defineProperty){Object.defineProperty(CSSStyleDeclaration.prototype,"polyfilter",{get:function(){return this.polyfilterStore},set:function(e){values=e.split(/\)\s+/);var n={filtersW3C:[],filtersWebKit:[],filtersSVG:[],filtersIE:[],behaviorsIE:[]};for(idx in values){var r=values[idx]+")";currentproperties=t.convert(r);for(key in currentproperties){if(typeof n[key]!=="undefined"){n[key]=n[key].concat(currentproperties[key])}}}if(n["filtersW3C"].length>0){if(typeof t._ie==="undefined"){this.msFilter=n["filtersW3C"].join(" ")}this.webkitFilter=this.mozFilter=this.oFilter=n["filtersW3C"].join(" ")}if(n["filtersWebKit"].length>0){this.webkitFilter=n["filtersWebKit"].join(" ")}if(n["filtersSVG"].length>0){if(n["filtersSVG"][0]!="none"){var i=e.replace(/[^a-z0-9]/g,"");if(typeof t._svg_cache[i]==="undefined"){t._svg_cache[i]=t._create_svg(i,n["filtersSVG"]);if(typeof XMLSerializer==="undefined"){document.body.appendChild(t._svg_cache[i])}else{var s=new XMLSerializer;var o=s.serializeToString(t._svg_cache[i]);if(o.search("SourceGraphic")!=-1){document.body.appendChild(t._svg_cache[i])}}}if(typeof XMLSerializer==="undefined"){this.filter="url(#"+i+")"}else{var s=new XMLSerializer;var o=s.serializeToString(t._svg_cache[i]);if(o.search("SourceGraphic")!=-1){this.filter="url(#"+i+")"}else{this.filter="url('data:image/svg+xml;utf8,"+o+"#"+i+"')"}}}else{this.filter="none"}}if(typeof t._ie!=="undefined"){if(n["filtersIE"].length>0){this.filter=n["filtersIE"].join(" ")}else{this.filter=""}if(n["behaviorsIE"].length>0){this.behavior=n["behaviorsIE"].join(" ")}else{this.behavior=""}}this.polyfilterStore=e}})}},convert:function(e){var t=e.match(/none/i);if(t!==null){var n=this.filters.none()}var t=e.match(/(grayscale)\(([0-9\.]+)\)/i);if(t!==null){var r=parseFloat(t[2],10),n=this.filters.grayscale(r)}var t=e.match(/(sepia)\(([0-9\.]+)\)/i);if(t!==null){var r=parseFloat(t[2],10),n=this.filters.sepia(r)}var t=e.match(/(blur)\(([0-9]+)[px]*\)/i);if(t!==null){var r=parseInt(t[2],10),n=this.filters.blur(r)}var t=e.match(/(invert)\(([0-9\.]+)\)/i);if(t!==null){var r=parseFloat(t[2],10),n=this.filters.invert(r)}var t=e.match(/(brightness)\(([0-9\.]+)%\)/i);if(t!==null){var r=parseFloat(t[2],10),n=this.filters.brightness(r)}var t=e.match(/(drop\-shadow)\(([0-9]+)[px]*\s+([0-9]+)[px]*\s+([0-9]+)[px]*\s+([#0-9]+)\)/i);if(t!==null){var i=parseInt(t[2],10),s=parseInt(t[3],10),o=parseInt(t[4],10),u=t[5],n=this.filters.dropShadow(i,s,o,u)}return n},filters:{none:function(){var e={};if(typeof t._ie==="undefined"){e["filtersW3C"]=["none"];e["filtersSVG"]=["none"]}else{e["filtersIE"]=["none"]}return e},grayscale:function(e){e=e||0;var n={};if(typeof t._ie==="undefined"){n["filtersW3C"]=["grayscale("+e+")"];var r=t._create_svg_element("feColorMatrix",{type:"matrix",values:.2126+.7874*(1-e)+" "+(.7152-.7152*(1-e))+" "+(.0722-.0722*(1-e))+" 0 0 "+(.2126-.2126*(1-e))+" "+(.7152+.2848*(1-e))+" "+(.0722-.0722*(1-e))+" 0 0 "+(.2126-.2126*(1-e))+" "+(.7152-.7152*(1-e))+" "+(.0722+.9278*(1-e))+" 0 0 0 0 0 1 0"});n["filtersSVG"]=[r]}else{n["filtersIE"]=e>=.5?["gray"]:[]}return n},sepia:function(e){e=e||0;var n={};if(typeof t._ie==="undefined"){n["filtersW3C"]=["sepia("+e+")"];var r=t._create_svg_element("feColorMatrix",{type:"matrix",values:.393+.607*(1-e)+" "+(.769-.769*(1-e))+" "+(.189-.189*(1-e))+" 0 0 "+(.349-.349*(1-e))+" "+(.686+.314*(1-e))+" "+(.168-.168*(1-e))+" 0 0 "+(.272-.272*(1-e))+" "+(.534-.534*(1-e))+" "+(.131+.869*(1-e))+" 0 0 0 0 0 1 0"});n["filtersSVG"]=[r]}else{n["filtersIE"]=e>=.5?["gray","progid:DXImageTransform.Microsoft.Light()"]:[];n["behaviorsIE"]=e>=.5?['url("'+t.scriptpath+'htc/sepia.htc")']:[]}return n},blur:function(e){e=Math.round(e)||0;var n={};if(typeof t._ie==="undefined"){n["filtersW3C"]=["blur("+e+"px)"];var r=t._create_svg_element("feGaussianBlur",{"in":"SourceGraphic",stdDeviation:e});n["filtersSVG"]=[r]}else{n["filtersIE"]=["progid:DXImageTransform.Microsoft.Blur(pixelradius="+e+")"]}return n},invert:function(e){e=e||0;var n={};if(typeof t._ie==="undefined"){n["filtersW3C"]=["invert("+e+")"];var r=t._create_svg_element("feComponentTransfer",{});var i=t._create_svg_element("feFuncR",{type:"table",tableValues:e+" "+(1-e)});r.appendChild(i);var i=t._create_svg_element("feFuncG",{type:"table",tableValues:e+" "+(1-e)});r.appendChild(i);var i=t._create_svg_element("feFuncB",{type:"table",tableValues:e+" "+(1-e)});r.appendChild(i);n["filtersSVG"]=[r]}else{n["filtersIE"]=e>=.5?["invert"]:[]}return n},brightness:function(e){e=e||0;var n={};if(typeof t._ie==="undefined"){n["filtersW3C"]=["brightness("+e+"%)"];n["filtersWebKit"]=["brightness("+(e-100)+"%)"];var r=t._create_svg_element("feComponentTransfer",{});var i=t._create_svg_element("feFuncR",{type:"linear",slope:e/100});r.appendChild(i);var i=t._create_svg_element("feFuncG",{type:"linear",slope:e/100});r.appendChild(i);var i=t._create_svg_element("feFuncB",{type:"linear",slope:e/100});r.appendChild(i);n["filtersSVG"]=[r]}else{n["filtersIE"]=["progid:DXImageTransform.Microsoft.Light()"];n["behaviorsIE"]=['url("'+t.scriptpath+'htc/brightness.htc")']}return n},dropShadow:function(e,n,r,i){e=Math.round(e)||0;n=Math.round(n)||0;r=Math.round(r)||0;i=i||"#000000";var s={};if(typeof t._ie==="undefined"){s["filtersW3C"]=["drop-shadow("+e+"px "+n+"px "+r+"px "+i+")"];var o=t._create_svg_element("feGaussianBlur",{"in":"SourceAlpha",stdDeviation:r});var u=t._create_svg_element("feOffset",{dx:e+1,dy:n+1,result:"offsetblur"});var a=t._create_svg_element("feFlood",{"flood-color":i});var f=t._create_svg_element("feComposite",{in2:"offsetblur",operator:"in"});var l=t._create_svg_element("feMerge",{});var c=t._create_svg_element("feMergeNode",{});l.appendChild(c);var c=t._create_svg_element("feMergeNode",{"in":"SourceGraphic"});l.appendChild(c);s["filtersSVG"]=[o,u,a,f,l]}else{s["filtersIE"]=["progid:DXImageTransform.Microsoft.Glow(color="+i+",strength=0)","progid:DXImageTransform.Microsoft.Shadow(color="+i+",strength=0)"];s["behaviorsIE"]=['url("'+t.scriptpath+'htc/drop-shadow.htc")']}return s}}};if(e.jQuery){e.jQuery(document).ready(function(e){t.process_stylesheets()})}else if(e.contentLoaded){contentLoaded(e,function(){t.process_stylesheets()})}else{if(e.addEventListener){document.addEventListener("DOMContentLoaded",function(){t.process_stylesheets()},false)}else if(e.attachEvent){e.attachEvent("onload",function(){t.process_stylesheets()})}}t.init()})(window)